<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>wheyu blog</title>
  <script src="https://cdn.bootcdn.net/ajax/libs/marked/4.3.0/marked.min.js"></script>
  <script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
  <div id="header">
    <ul>
      <li>主页</li>
      <li class="article">文章
        <ul id="articleList">
        </ul>
      </li>
      <li class="tool">工具
        <ul id="toolList">
        </ul>
      </li>
      <li>关于</li>
    </ul>
  </div>
  <div id="content"></div>
  <script>
    $(function () {

      var data = $.ajax({
        url: 'data.json',//json文件位置，文件名
        type: "GET",//请求方式为get
        dataType: "json", //返回数据格式为json
        async: false,
        success: function (data) {//请求成功完成后要执行的方法
        }
      });
      var obj = null
      try {
        obj = JSON.parse(data.responseText)
      } catch (error) {
      }
      console.log("====== obj ", obj)
      if (!obj) {
        alert("获取数据出错")
        return
      }

      $("#toolList").children().remove()
      obj.toolList.forEach(tool => {
        $("#toolList").append(`<li><a target='_blank' href='${tool.path}'>${tool.name}</a></li>`)
      });

      $("#articleList").children().remove()
      obj.articleList.forEach(article => {
        $("#articleList").append(`<li class='loadArticle' value='${article.path}'>${article.name}</li>`)

        $('.loadArticle').click((event) => {
          try {
            var path = $(event.target).attr("value")
            if (!path || path.length == 0) {
              throw '无效地址'
            }
            a = $.ajax({
              url: path,//json文件位置，文件名
              type: "GET",//请求方式为get
              dataType: "text", //返回数据格式为json
              async: false,
              success: function (data) {//请求成功完成后要执行的方法
              }
            });
            aa = a.responseText;
            var htmlData = ""
            console.log("=====  path  ", path)
            if (path.indexOf('.md') >= 0) {
              htmlData = marked.parse(aa);
            } else {
              htmlData = aa
            }
            console.log("=====  htmlData  ", htmlData)
            document.getElementById('content').innerHTML = htmlData

            $('.showclick').click((event) => {
              try {
                var value = $(event.target).attr("value")
                if (!value) {
                  throw '错误'
                }
                if (value == '已解密') {
                  return
                }
                var pwd = prompt("请输入密码", "");
                if (pwd == null) {
                  return
                }
                if (pwd.length == 0) {
                  throw '密码不能为空'
                }

                // var encrypted = CryptoJS.AES.encrypt(value, pwd).toString();
                var decrypted = CryptoJS.AES.decrypt(value, pwd).toString(CryptoJS.enc.Utf8);
                if (decrypted.length == 0) {
                  throw '解密错误'
                }
                $(event.target).text(decrypted)
                $(event.target).attr("value", '已解密')
              } catch (error) {
                alert(error)
              }
            })
          } catch (error) {
            alert(error)
          }
        })

      })

      $('.tool').hover(() => {
        $('#toolList').show();
      }, () => {
        $('#toolList').hide();
      })
      $('.article').hover(() => {
        $('#articleList').show();
      }, () => {
        $('#articleList').hide();
      })

      $('#articleList').hide();
      $('#toolList').hide();
    });
  </script>
</body>
<style>
  * {
    padding: 0px;
    margin: 0px;
  }

  body {
    display: flex;
    justify-content: center;
    font-size: 14px;
    line-height: 1.6;
  }

  #content {
    max-width: 860px;
    width: 60%;
    margin-top: 60px;
    padding: 0px 30px 30px 30px;
  }

  .showclick {
    text-shadow: 1px 1px 2px #333;
    font-size: 26px;
    padding: 10px;
    border-radius: 5px;
  }

  table {
    border-collapse: collapse;
    width: 100%;
    text-align: left;
  }

  table tr:nth-child(2n),
  thead {
    background-color: #f8f8f8;
  }

  tr,
  td,
  th {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
  }

  td,
  th {
    padding: 6px 13px;
  }

  th {
    font-weight: bold;
  }

  pre {
    border-radius: 5px;
    padding: 5px 4px 5px 10px;
    font-size: 1.2em;
    background-color: #2d2d2d;
    color: white;
  }

  ul {
    list-style: none;
    padding-left: 1rem;
  }

  #header {
    position: fixed;
  }

  #header li {
    float: left;
    background: #30A6E6;
    color: #FFF;
    font-size: 26px;
    width: 150px;
    height: 50px;
    line-height: 50px;
    text-align: center;
    -webkit-transition: all .25s ease;
    -moz-transition: all .25s ease;
    -ms-transition: all .25s ease;
    -o-transition: all .25s ease;
    transition: all .25s ease;
    cursor: default;
  }

  #header li:hover,
  #toolList li,#articleList li {
    background: #1d648a;
  }

  #toolList li:hover, #articleList li:hover {
    background: #c07326;
  }

  #header li a {
    text-decoration: none;
    color: white;
  }

  #header ul {
    padding-left: 0rem;
  }

  #toolList li, #articleList li {
    float: none;
  }
</style>

</html>