<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>wheyu blog</title>
  <script src="https://cdn.bootcdn.net/ajax/libs/marked/4.3.0/marked.min.js"></script>
  <script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
  <div id="header">
    <ul>
      <li>主页</li>
      <li class="article">文章
        <ul id="articleList">
        </ul>
      </li>
      <li class="tool">工具
        <ul id="toolList">
        </ul>
      </li>
      <li>关于</li>
    </ul>
  </div>
  <div id="content"></div>
  <script>
    $(function () {

      var data = $.ajax({
        url: 'data.json',//json文件位置，文件名
        type: "GET",//请求方式为get
        dataType: "json", //返回数据格式为json
        async: false,
        success: function (data) {//请求成功完成后要执行的方法
        }
      });
      var obj = null
      try {
        obj = JSON.parse(data.responseText)
      } catch (error) {
      }
      console.log("====== obj ", obj)
      if (!obj) {
        alert("获取数据出错")
        return
      }

      $("#toolList").children().remove()
      obj.toolList.forEach(tool => {
        $("#toolList").append(`<li><a target='_blank' href='${tool.path}'>${tool.name}</a></li>`)
      });

      $("#articleList").children().remove()
      obj.articleList.forEach(article => {
        $("#articleList").append(`<li class='loadArticle' value='${article.path}'>${article.name}</li>`)

        $('.loadArticle').click((event) => {
          try {
            var path = $(event.target).attr("value")
            if (!path || path.length == 0) {
              throw '无效地址'
            }
            a = $.ajax({
              url: path,//json文件位置，文件名
              type: "GET",//请求方式为get
              dataType: "text", //返回数据格式为json
              async: false,
              success: function (data) {//请求成功完成后要执行的方法
              }
            });
            aa = a.responseText;
            var htmlData = ""
            console.log("=====  path  ", path)
            if (path.indexOf('.md') >= 0) {
              htmlData = marked.parse(aa);
            } else {
              htmlData = aa
            }
            console.log("=====  htmlData  ", htmlData)
            document.getElementById('content').innerHTML = htmlData

            $('.showclick').click((event) => {
              try {
                var value = $(event.target).attr("value")
                if (!value) {
                  throw '错误'
                }
                if (value == '已解密') {
                  return
                }
                var pwd = prompt("请输入密码", "");
                if (pwd == null) {
                  return
                }
                if (pwd.length == 0) {
                  throw '密码不能为空'
                }

                // var encrypted = CryptoJS.AES.encrypt(value, pwd).toString();
                var decrypted = CryptoJS.AES.decrypt(value, pwd).toString(CryptoJS.enc.Utf8);
                if (decrypted.length == 0) {
                  throw '解密错误'
                }
                $(event.target).text(decrypted)
                $(event.target).attr("value", '已解密')
              } catch (error) {
                alert(error)
              }
            })
          } catch (error) {
            alert(error)
          }
        })

      })

      $('.tool').hover(() => {
        $('#toolList').show();
      }, () => {
        $('#toolList').hide();
      })
      $('.article').hover(() => {
        $('#articleList').show();
      }, () => {
        $('#articleList').hide();
      })

      $('#articleList').hide();
      $('#toolList').hide();
    });
  </script>
</body>
<style>
  * {
    padding: 0px;
    margin: 0px;
  }

  body {
    display: flex;
    justify-content: center;
    font-size: 16px;
    line-height: 1.6;
  }

  .showclick {
    text-shadow: 1px 1px 2px #333;
    font-size: 26px;
    padding: 10px;
    border-radius: 5px;
  }


  #header {
    position: fixed;
  }

  #header li {
    float: left;
    background: #30A6E6;
    color: #FFF;
    font-size: 26px;
    width: 150px;
    height: 50px;
    line-height: 50px;
    text-align: center;
    -webkit-transition: all .25s ease;
    -moz-transition: all .25s ease;
    -ms-transition: all .25s ease;
    -o-transition: all .25s ease;
    transition: all .25s ease;
    cursor: default;
  }

  #header li:hover,
  #toolList li,
  #articleList li {
    background: #1d648a;
  }

  #toolList li:hover,
  #articleList li:hover {
    background: #c07326;
  }

  #header li a {
    text-decoration: none;
    color: white;
  }

  #header ul {
    padding-left: 0em;
  }

  #toolList li,
  #articleList li {
    float: none;
  }

  #content {
    max-width: 860px;
    padding: 0px 30px 30px 30px;
    margin: 60px 0px 10px 0px;
    border-radius: 8px;
    box-shadow: 0 1px 4px #aaa;
  }


  /* md 样式修改 */
  #content p {
    padding-left: 1em;
    margin: 0.5em 0em 0em 0em;
  }



  /* 标题 */
  h1 {
    font-size: 2.6em;
  }

  h2 {
    font-size: 2.2em;
  }

  h3 {
    font-size: 1.9em;
  }

  h4 {
    font-size: 1.6em;
  }

  h5 {
    font-size: 1.3em;
  }

  h6 {
    font-size: 1em;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin: 0.5em 0 0 0;
  }

  /* 列表 */
  #content ul li::before {
    content: "";
    background-color: gray;
    border: solid 1px gray;
    border-radius: 50%;
    display: inline-block;
    height: 0.5em;
    width: 0.5em;
    margin-right: 0.5em;
  }

  #content li ul li::before {
    background-color: white;
  }

  #content li {
    margin: 0.5em 0 0 0;
  }

  /* 分隔线 */
  hr {
    margin: 0.5em 0px;
  }

  /* 代码字段 */
  code {
    color: red;
    font-weight: 600;
    font-size: 1.1em;
    background-color: #eee;
    padding: 0.2em 0.3em;
    margin: 0.1em;
  }

  /* 代码块 */
  pre {
    border-radius: 5px;
    padding: 0.5em;
    margin: 0.5em 0 0 1em;
    background-color: #f4f4f4;
    border: solid 1px lightgray;
    color: white;
  }
  pre code {
    color: black;
    font-size: 1.2em;
    background-color: transparent;
    padding: 0;
    margin: 0em;
  }



  /* 区块 */

  blockquote {
    margin-left: 1em;
    margin-top: 0.5em;
    border-left: 4px solid #c2c2c2;
    color: #777;
  }

  /* 表格 */
  table {
    border-collapse: collapse;
    width: calc(100% - 1em);
    text-align: left;
    margin: 1em 0em 0em 1em;
  }

  table tr:nth-child(2n),
  thead {
    background-color: #f8f8f8;
  }

  tr,
  td,
  th {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
  }

  td,
  th {
    padding: 6px 13px;
  }

  th {
    font-weight: bold;
  }

  ol {
    margin-left: 2em;
  }

  ul {
    list-style: none;
    padding-left: 1em;
  }
</style>

</html>