<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport"content="width=device-width, initial-scale=1.0"><title>æ–‡ä»¶æ–‡æœ¬æ›¿æ¢å·¥å…·</title><style>*{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}body{background-color:#f5f7fa;color:#333;line-height:1.6;padding:20px;max-width:900px;margin:0 auto}header{text-align:center;margin-bottom:30px;padding:20px;background:linear-gradient(135deg,#6e8efb,#a777e3);color:white;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1)}h1{font-size:2rem;margin-bottom:10px}.container{display:grid;gap:20px}.input-section,.files-section,.conditions-section{background:white;padding:20px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.08)}.form-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:600;color:#555}input[type="text"]{width:100%;padding:10px;border:1px solid#ddd;border-radius:5px;font-size:16px}.drop-zone{border:2px dashed#6e8efb;border-radius:8px;padding:25px;text-align:center;cursor:pointer;transition:all 0.3s;background-color:rgba(110,142,251,0.05);margin-bottom:15px}.drop-zone:hover,.drop-zone.drag-over{background-color:rgba(110,142,251,0.15)}.file-count{text-align:center;margin-bottom:15px;font-weight:600;color:#6e8efb}.btn{background:linear-gradient(135deg,#6e8efb,#a777e3);color:white;border:none;padding:10px 15px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all 0.3s}.btn:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.15)}.btn:disabled{background:#ccc;cursor:not-allowed;transform:none;box-shadow:none}.btn-sm{padding:6px 10px;font-size:12px}.btn-danger{background:linear-gradient(135deg,#ff6b6b,#ee5a52)}.btn-success{background:linear-gradient(135deg,#1dd1a1,#10ac84)}.file-list{margin-top:15px;max-height:300px;overflow-y:auto}.file-item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#f8f9fa;border-radius:6px;margin-bottom:8px;border-left:4px solid#6e8efb}.file-name{font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.file-status{font-size:12px;padding:4px 8px;border-radius:12px;margin-left:10px}.status-pending{background:#ffeeba;color:#856404}.status-completed{background:#c3e6cb;color:#155724}.conditions-list{margin-top:15px;display:flex;flex-wrap:wrap;gap:5px}.condition-item{display:flex;align-items:center;padding:5px;background:#f8f9fa;border:solid 1px#ddd;border-radius:6px;margin-bottom:10px;gap:4px}.condition-pattern{flex:1;font-family:monospace;padding-left:4px;padding-right:8px;font-size:1rem;font-weight:600}.condition-negate{display:flex;align-items:center;white-space:nowrap}.condition-actions{display:flex;gap:5px}.drag-handle{cursor:move;padding:5px;color:#6c757d}.notification{position:fixed;top:20px;right:20px;padding:15px 20px;border-radius:6px;color:white;opacity:0;transform:translateX(100%);transition:all 0.3s;z-index:1000}.notification.show{opacity:1;transform:translateX(0)}.notification.success{background:#28a745}.notification.error{background:#dc3545}.empty-message{text-align:center;color:#6c757d;padding:20px}.regex-help{font-size:12px;color:#6c757d;margin-top:5px}.section-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.toggle-btn{background:none;border:none;color:#6e8efb;cursor:pointer;font-size:14px}.condition-type{font-size:12px;padding:2px 6px;border-radius:4px;background:#e9ecef;cursor:default}.type-include{background:#d4edda;color:#155724}.type-exclude{background:#f8d7da;color:#721c24}</style></head><body><header><h1>æ–‡ä»¶æ–‡æœ¬æ›¿æ¢å·¥å…·</h1><p>æ‹–å…¥å¤šä¸ªæ–‡ä»¶ï¼ŒæŒ‰æ­£åˆ™æ¡ä»¶ç­›é€‰è¡Œå¹¶æ›¿æ¢æ–‡æœ¬å†…å®¹</p></header><div class="container"><div class="conditions-section"><div class="section-title"><h2>è¡Œç­›é€‰æ¡ä»¶ï¼ˆæ­£åˆ™ï¼‰</h2><button class="toggle-btn"id="toggleHelp">è¯´æ˜</button></div><div class="form-group"id="helpText"style="display: none;"><p>é¦–å…ˆä½¿ç”¨æ­£åˆ™æ¡ä»¶ç­›é€‰è¡Œï¼Œç„¶ååœ¨åŒ¹é…çš„è¡Œä¸­è¿›è¡Œæ–‡æœ¬æ›¿æ¢ï¼š</p><ol><li>æ·»åŠ æ­£åˆ™è¡¨è¾¾å¼æ¥ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è¡Œ</li><li>é€‰æ‹©"åŒ…å«"æˆ–"æ’é™¤"æ¨¡å¼</li><li>åœ¨ä¸‹æ–¹è®¾ç½®è¦æŸ¥æ‰¾å’Œæ›¿æ¢çš„æ–‡æœ¬</li><li>åªæœ‰ç¬¦åˆç­›é€‰æ¡ä»¶çš„è¡Œæ‰ä¼šè¿›è¡Œæ–‡æœ¬æ›¿æ¢</li></ol></div><div class="form-group"><label for="newCondition">æ–°ç­›é€‰æ¡ä»¶ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ï¼š</label><input type="text"id="newCondition"placeholder="è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"><!--<div class="regex-help">ä¾‹å¦‚ï¼š^error|warning$æˆ–\d{3,}</div>--></div><div class="form-group"><label for="negateCondition"><input type="checkbox"id="negateCondition">æ’é™¤åŒ¹é…çš„è¡Œï¼ˆå–åï¼‰</label></div><button class="btn"id="addConditionBtn">æ·»åŠ æ¡ä»¶</button><div class="conditions-list"id="conditionsList"><div class="empty-message">æš‚æ— ç­›é€‰æ¡ä»¶ï¼Œæ‰€æœ‰è¡Œéƒ½å°†è¢«å¤„ç†</div></div></div><div class="input-section"><h2>æ–‡æœ¬æ›¿æ¢è®¾ç½®</h2><div class="form-group"><label for="matchText">æŸ¥æ‰¾æ–‡æœ¬ï¼š</label><input type="text"id="matchText"placeholder="è¾“å…¥è¦æŸ¥æ‰¾çš„æ–‡æœ¬"></div><div class="form-group"><label for="replaceText">æ›¿æ¢æ–‡æœ¬ï¼š</label><input type="text"id="replaceText"placeholder="è¾“å…¥è¦æ›¿æ¢æˆçš„æ–‡æœ¬"></div><div class="drop-zone"id="dropZone"><p>ğŸ“æ‹–æ”¾æ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–<strong>ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</strong></p><p class="file-count"id="fileCount">å·²é€‰æ‹©0ä¸ªæ–‡ä»¶</p></div><button class="btn"id="processBtn"disabled>å¤„ç†æ–‡ä»¶</button><button class="btn btn-success"style="margin-left: 8px;"id="downloadBtn"disabled>æ‰“åŒ…ä¸‹è½½æ‰€æœ‰æ–‡ä»¶</button></div><div class="files-section"><h2>æ–‡ä»¶åˆ—è¡¨</h2><div class="file-list"id="fileList"><div class="empty-message">æš‚æ— æ–‡ä»¶ï¼Œè¯·æ‹–æ”¾æˆ–é€‰æ‹©æ–‡ä»¶</div></div></div></div><div class="notification"id="notification"></div><script>document.addEventListener('DOMContentLoaded',function(){const dropZone=document.getElementById('dropZone');const fileInput=document.createElement('input');fileInput.type='file';fileInput.multiple=true;fileInput.style.display='none';document.body.appendChild(fileInput);const processBtn=document.getElementById('processBtn');const downloadBtn=document.getElementById('downloadBtn');const fileList=document.getElementById('fileList');const fileCount=document.getElementById('fileCount');const matchText=document.getElementById('matchText');const replaceText=document.getElementById('replaceText');const notification=document.getElementById('notification');const conditionsList=document.getElementById('conditionsList');const addConditionBtn=document.getElementById('addConditionBtn');const newCondition=document.getElementById('newCondition');const negateCondition=document.getElementById('negateCondition');const toggleHelp=document.getElementById('toggleHelp');const helpText=document.getElementById('helpText');let files=[];let processedFiles=[];let conditions=[];dropZone.addEventListener('click',()=>{fileInput.click()});fileInput.addEventListener('change',(e)=>{handleFiles(e.target.files);fileInput.value=''});dropZone.addEventListener('dragover',(e)=>{e.preventDefault();dropZone.classList.add('drag-over')});dropZone.addEventListener('dragleave',()=>{dropZone.classList.remove('drag-over')});dropZone.addEventListener('drop',(e)=>{e.preventDefault();dropZone.classList.remove('drag-over');handleFiles(e.dataTransfer.files)});processBtn.addEventListener('click',processFiles);downloadBtn.addEventListener('click',downloadAllFiles);addConditionBtn.addEventListener('click',addCondition);toggleHelp.addEventListener('click',()=>{helpText.style.display=helpText.style.display==='none'?'block':'none'});function showNotification(message,isSuccess=true){notification.textContent=message;notification.className='notification '+(isSuccess?'success':'error');notification.classList.add('show');setTimeout(()=>{notification.classList.remove('show')},3000)}function addCondition(){const pattern=newCondition.value.trim();if(!pattern){showNotification('è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼',false);return}try{new RegExp(pattern)}catch(e){showNotification('æ— æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼: '+e.message,false);return}conditions.push({pattern:pattern,negate:negateCondition.checked});updateConditionsList();newCondition.value='';negateCondition.checked=false}function removeCondition(index){conditions.splice(index,1);updateConditionsList()}function updateConditionsList(){conditionsList.innerHTML='';if(conditions.length===0){conditionsList.innerHTML='<div class="empty-message">æš‚æ— ç­›é€‰æ¡ä»¶ï¼Œæ‰€æœ‰è¡Œéƒ½å°†è¢«å¤„ç†</div>';return}conditions.forEach((condition,index)=>{const conditionItem=document.createElement('div');conditionItem.className='condition-item';const patternText=document.createElement('div');patternText.className='condition-pattern';patternText.textContent=condition.pattern;const conditionType=document.createElement('div');conditionType.className=`condition-type ${condition.negate?'type-exclude':'type-include'}`;conditionType.textContent=condition.negate?'æ’é™¤':'åŒ…å«';const actions=document.createElement('div');actions.className='condition-actions';const deleteBtn=document.createElement('button');deleteBtn.className='btn btn-sm btn-danger';deleteBtn.textContent='åˆ é™¤';deleteBtn.addEventListener('click',()=>removeCondition(index));actions.appendChild(deleteBtn);conditionItem.appendChild(patternText);conditionItem.appendChild(conditionType);conditionItem.appendChild(actions);conditionsList.appendChild(conditionItem)})}function handleFiles(newFiles){if(newFiles.length===0)return;for(let i=0;i<newFiles.length;i++){const file=newFiles[i];if(files.some(f=>f.name===file.name&&f.size===file.size)){continue}files.push(file)}updateFileList()}function updateFileList(){fileList.innerHTML='';fileCount.textContent=`å·²é€‰æ‹©${files.length}ä¸ªæ–‡ä»¶`;if(files.length===0){fileList.innerHTML='<div class="empty-message">æš‚æ— æ–‡ä»¶ï¼Œè¯·æ‹–æ”¾æˆ–é€‰æ‹©æ–‡ä»¶</div>';processBtn.disabled=true;downloadBtn.disabled=true;return}processBtn.disabled=false;files.forEach(file=>{const fileItem=document.createElement('div');fileItem.className='file-item';const fileName=document.createElement('div');fileName.className='file-name';fileName.textContent=file.name;const fileStatus=document.createElement('span');fileStatus.className='file-status status-pending';fileStatus.textContent='ç­‰å¾…å¤„ç†';fileItem.appendChild(fileName);fileItem.appendChild(fileStatus);fileList.appendChild(fileItem)})}function lineMatchesConditions(line){if(conditions.length===0)return true;for(const condition of conditions){try{const regex=new RegExp(condition.pattern);const matches=regex.test(line);if(condition.negate){if(matches)return false}else{if(!matches)return false}}catch(e){console.error('æ— æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼:',condition.pattern,e);continue}}return true}function processFiles(){const match=matchText.value;const replace=replaceText.value;if(!match){showNotification('è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„æ–‡æœ¬',false);return}if(files.length===0){showNotification('è¯·æ·»åŠ è‡³å°‘ä¸€ä¸ªæ–‡ä»¶',false);return}processedFiles=[];let processedCount=0;files.forEach((file,index)=>{const fileItems=document.querySelectorAll('.file-item');const fileStatus=fileItems[index].querySelector('.file-status');fileStatus.textContent='å¤„ç†ä¸­...';fileStatus.className='file-status status-pending';const reader=new FileReader();reader.onload=function(e){try{let content=e.target.result;let newContent;const lines=content.split('\n');const processedLines=lines.map(line=>{if(lineMatchesConditions(line)){return line.replace(new RegExp(match,'g'),replace)}return line});newContent=processedLines.join('\n');const newFile=new Blob([newContent],{type:file.type});processedFiles.push({original:file,processed:newFile,name:file.name});fileStatus.textContent='å¤„ç†å®Œæˆ';fileStatus.className='file-status status-completed';processedCount++;if(processedCount===files.length){downloadBtn.disabled=false;showNotification('æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆï¼')}}catch(error){fileStatus.textContent='å¤„ç†å¤±è´¥';fileStatus.className='file-status status-pending';console.error('æ–‡ä»¶å¤„ç†é”™è¯¯:',error);processedCount++}};reader.onerror=function(){fileStatus.textContent='è¯»å–å¤±è´¥';fileStatus.className='file-status status-pending';processedCount++};reader.readAsText(file)})}function downloadAllFiles(){if(processedFiles.length===0){showNotification('æ²¡æœ‰å¯ä¸‹è½½çš„æ–‡ä»¶',false);return}if(processedFiles.length===1){const file=processedFiles[0];const url=URL.createObjectURL(file.processed);const a=document.createElement('a');a.href=url;a.download=file.name;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);showNotification('æ–‡ä»¶ä¸‹è½½å®Œæˆï¼');return}function createZip(files,callback){const zipParts=[];const centralDirectory=[];let offset=0;const processNextFile=(index)=>{if(index>=files.length){const zipContent=zipParts.join('')+centralDirectory.join('')+`PK\x05\x06\x00\x00\x00\x00`+String.fromCharCode(files.length&0xff)+String.fromCharCode((files.length>>8)&0xff)+String.fromCharCode(files.length&0xff)+String.fromCharCode((files.length>>8)&0xff)+String.fromCharCode(offset&0xff)+String.fromCharCode((offset>>8)&0xff)+String.fromCharCode((offset>>16)&0xff)+String.fromCharCode((offset>>24)&0xff)+String.fromCharCode(centralDirectory.join('').length&0xff)+String.fromCharCode((centralDirectory.join('').length>>8)&0xff)+String.fromCharCode((centralDirectory.join('').length>>16)&0xff)+String.fromCharCode((centralDirectory.join('').length>>24)&0xff)+'\x00\x00';const zipBlob=new Blob([zipContent],{type:'application/zip'});callback(zipBlob);return}const file=files[index];const reader=new FileReader();reader.onload=function(e){const content=e.target.result;const fileName=file.name;const localHeader=`PK\x03\x04\x14\x00\x00\x00\x00\x00\x00\x00\x00\x00`;const nameLength=fileName.length;const contentLength=content.length;const entry=localHeader+String.fromCharCode(contentLength&0xff)+String.fromCharCode((contentLength>>8)&0xff)+String.fromCharCode((contentLength>>16)&0xff)+String.fromCharCode((contentLength>>24)&0xff)+String.fromCharCode(contentLength&0xff)+String.fromCharCode((contentLength>>8)&0xff)+String.fromCharCode((contentLength>>16)&0xff)+String.fromCharCode((contentLength>>24)&0xff)+String.fromCharCode(nameLength&0xff)+String.fromCharCode((nameLength>>8)&0xff)+'\x00\x00'+fileName+content;zipParts.push(entry);const centralRecord=`PK\x01\x02\x14\x00\x14\x00\x00\x00\x00\x00\x00\x00\x00\x00`+String.fromCharCode(contentLength&0xff)+String.fromCharCode((contentLength>>8)&0xff)+String.fromCharCode((contentLength>>16)&0xff)+String.fromCharCode((contentLength>>24)&0xff)+String.fromCharCode(contentLength&0xff)+String.fromCharCode((contentLength>>8)&0xff)+String.fromCharCode((contentLength>>16)&0xff)+String.fromCharCode((contentLength>>24)&0xff)+String.fromCharCode(nameLength&0xff)+String.fromCharCode((nameLength>>8)&0xff)+'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'+String.fromCharCode(offset&0xff)+String.fromCharCode((offset>>8)&0xff)+String.fromCharCode((offset>>16)&0xff)+String.fromCharCode((offset>>24)&0xff)+fileName;centralDirectory.push(centralRecord);offset+=entry.length;processNextFile(index+1)};reader.readAsText(file.processed)};processNextFile(0)}createZip(processedFiles,function(zipBlob){const url=URL.createObjectURL(zipBlob);const a=document.createElement('a');a.href=url;a.download='processed_files.zip';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);showNotification('æ–‡ä»¶æ‰“åŒ…ä¸‹è½½å®Œæˆï¼')})}updateConditionsList()});</script></body></html>